import FirescriptRuntime as FirescriptRuntime from '..'
import * as inspect from 'inspect.js'

describe('Typing', () =>
  describe('str', () =>
    it('validates if input is typeof str', () =>
      inspect(FirescriptRuntime.typing).withArgs(FirescriptRuntime.TYPE_STR, 'banana').doesNotThrow()
    )

    it('fails typeof str check with a num', () =>
      inspect(FirescriptRuntime.typing).withArgs(FirescriptRuntime.TYPE_STR, 123).doesThrow(TypeError)
    )
  )

  describe('arr', () =>
    it('validates if input is typeof array', () =>
      inspect(FirescriptRuntime.typing).withArgs(FirescriptRuntime.TYPE_ARR, ['banana']).doesNotThrow()
    )

    it('fails typeof str check with an obj', () =>
      inspect(FirescriptRuntime.typing).withArgs(FirescriptRuntime.TYPE_ARR, {}).doesThrow(TypeError)
    )
  )

  describe('bool', () =>
    it('validates if input is typeof boolean', () =>
      inspect(FirescriptRuntime.typing).withArgs(FirescriptRuntime.TYPE_BOOL, true).doesNotThrow()
    )

    it('fails typeof str check with a string', () =>
      inspect(FirescriptRuntime.typing).withArgs(FirescriptRuntime.TYPE_BOOL, 'true').doesThrow(TypeError)
    )
  )

  describe('func', () =>
    it('validates if input is typeof function', () =>
      const fn = () =>
      inspect(FirescriptRuntime.typing).withArgs(FirescriptRuntime.TYPE_FUNC, fn).doesNotThrow()
    )

    it('fails typeof str check with a string', () =>
      inspect(FirescriptRuntime.typing).withArgs(FirescriptRuntime.TYPE_FUNC, 'test').doesThrow(TypeError)
    )
  )

  describe('num', () =>
    it('validates if input is typeof number', () =>
      inspect(FirescriptRuntime.typing).withArgs(FirescriptRuntime.TYPE_NUM, 123).doesNotThrow()
    )

    it('fails typeof str check with a string', () =>
      inspect(FirescriptRuntime.typing).withArgs(FirescriptRuntime.TYPE_NUM, '123').doesThrow(TypeError)
    )
  )

  describe('obj', () =>
    it('validates if input is typeof object', () =>
      inspect(FirescriptRuntime.typing).withArgs(FirescriptRuntime.TYPE_OBJ, {}).doesNotThrow()
    )

    it('fails typeof str check with an array', () =>
      inspect(FirescriptRuntime.typing).withArgs(FirescriptRuntime.TYPE_OBJ, []).doesThrow(TypeError)
    )
  )

  describe('reg', () =>
    it('validates if input is typeof regexp', () =>
      const reg = new RegExp('foo')
      inspect(FirescriptRuntime.typing).withArgs(FirescriptRuntime.TYPE_REG, reg).doesNotThrow()
    )

    it('fails typeof str check with a string', () =>
      inspect(FirescriptRuntime.typing).withArgs(FirescriptRuntime.TYPE_REG, '/123/').doesThrow(TypeError)
    )
  )
)
